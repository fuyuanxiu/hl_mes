<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<script src="../js/mui.min.js"></script>
		<script src="../js/jquery.js"></script>
		<script src="../js/jquery-1.11.1.js"></script>
		<script src="../js/api.js"></script>
		<script src="../js/common.js"></script>
		<script src="../js/template-web.js"></script>
		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/iconfont.css" />
		<style type="text/css">
			.productConten .mui-input-group {
				padding: 0.125rem;
			}

			.colorBg {
				background: -moz-linear-gradient(top, #34dbfc 0%, #61a7fd 100%);
				background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #1fd5e6), color-stop(100%, #21b6f8));
				background: -webkit-linear-gradient(top, #34dbfc 0%, #61a7fd 100%);
				background: -o-linear-gradient(top, #34dbfc 0%, #61a7fd 100%);
				background: -ms-linear-gradient(top, #34dbfc 0%, #61a7fd 100%);
				background: linear-gradient(to bottom, #34dbfc 0%, #61a7fd 100%);
			}

			.product-footer a {
				border-radius: 5px;
				-webkit-flex: 1;
				-webkit-box-flex: 1;
				flex: 1;
				color: #fff;
				text-decoration: none;
				background-color: rgb(255, 145, 0);
				padding: 10px;
				margin: 10px 20px;
			}

			.font-seal {
				font-size: 12px;
				z-index: 2;
				position: absolute;
				right: 14px;
				top: 25px;
				border: 1px solid #F73A3C;
				transform: rotate(25deg);
				width: 43px;
				line-height: 20px;
				text-align: center;
				color: #F73A3C;
				font-weight: bold;
			}

			.font-seal-ok {
				font-size: 12px;
				z-index: 2;
				position: absolute;
				right: 14px;
				top: 25px;
				border: 1px solid #00ff7f;
				transform: rotate(25deg);
				width: 43px;
				line-height: 20px;
				text-align: center;
				color: #00ff7f;
				font-weight: bold;
			}
			.mui-input-row label {
				font-size: large;
			}
		</style>
	</head>
	<body class="mui-fullscreen">
		<header class="mui-bar mui-bar-nav colorBg">
			<button type="button" class="mui-left mui-action-back mui-btn  mui-btn-link mui-btn-nav mui-pull-left">
				<span class="mui-icon mui-icon-left-nav"></span>
			</button>
			<h1 class="mui-title">报工审核</h1>
		</header>
		<div class="mui-content">
			<div class="mui-card">
				<div class="mui-card-header">
					<div class="mui-media-body">
						<ul class="mui-table-view">
							<li class="mui-table-view-cell ui-media">工单号:&nbsp; <span id="task_no"></span>&nbsp;&nbsp;&nbsp; 工序-设备: &nbsp;<span
								 id="proc_equ"></span></li>
							<li class="mui-table-view-cell ui-media">产品名称:&nbsp;<span id="board_name"></span></li>
							<li class="mui-table-view-cell ui-media">工单数量:&nbsp;<span id="plan_qty"></span>&nbsp;&nbsp;&nbsp;完成数量:&nbsp;<span
								 id="complete_qty"></span></li>
						</ul>
					</div>
				</div>
			</div>
			<div id="contentId">
				<script id='record-template' type="text/template">
					<% for(var i in record){ var item=record[i]; var check = $imports.checkInput(item.VERIFY) %>	
				<div class="mui-card">
				<div class="mui-card-content" id="list">
					<ul class="mui-table-view">
					<li class="mui-table-view-cell ui-media" data-id="<%=(item.ID)%>">
					{{if item.VERIFY=="0"}}
					<div class="font-seal">未审核</div>
					{{else}}
					<div class="font-seal-ok">已审核</div>
					{{/if}}	
						<div class="mui-input-row">
						<label>员工信息：</label>
						<input name="aplay_num" type="text"  disabled value="<%=(item.PERSON_NAME)%> (<%=(item.ASSESSOR)%>)">
					    </div>
						<div class="mui-input-row">
							<label>报工数量：</label>
							<input name="aplay_num" type="text"  disabled value="<%=(item.BG_QTY)%>">
						</div>
						<div class="mui-input-row">
							<label>审核数量：</label>
							<input name="audit_qty" type="text"  {{check}} value="<%=(item.AUDIT_QTY)%>">
						</div>
						<div class="mui-input-row">
							<label>良品数量：</label>
							<input name="qualified_qty" type="text"  {{check}} value="<%=(item.QUALIFIED_QTY)%>">
						</div>
						<div class="mui-input-row">
							<label>不良品数：</label>
							<input name="unqualified_qty" type="text" {{check}} value="<%=(item.UNQUALIFIED_QTY)%>">
						</div>
						<div class="mui-input-row">
							<label>报废数量：</label>
							<input name="bf_qty" type="text"  {{check}} value="<%=(item.BF_QTY)%>">
						</div>
					</li>
					</ul>
				</div>
				</div>
				<%}%>
				</script>
			</div>
		</div>

		<div class="mui-content-padded" align="center">
			<button type="button" class="mui-btn mui-btn-success" style="width: 100%;" id="sumbit">提 交 审 核</button>
		</div>
		<script type="text/javascript">
			mui.plusReady(function() {
				var param = plus.webview.currentWebview(); //获取父页面传递过来的参数
				var detail = param.detail;
				//console.log(detail)
				showDetailData(detail);
				getProduceVerifyDetail(detail)
			})

			template.defaults.imports.checkInput = function(item_verify) {
				if (item_verify == "0") {
					return "disabled";
				}
				return "";
			};


			function showDetailData(detail) {
				var data = JSON.parse(detail)
				$("#task_no").text(data.TASK_NO); //工单号
				$("#board_name").text(data.BOARD_NAME); //产品名称
				$("#proc_equ").text(data.PROC_NAM + " - " + data.EQU_NAME); //工序名称-设备名称
				$("#plan_qty").text(data.PLAN_QTY); //工单数量
				$("#complete_qty").text(data.COMPLETE_QTY); //完成数量
			}

			function getProduceVerifyDetail(detail) {
				var de_data = JSON.parse(detail)
				//console.log(detail)
				aj.post('/produceVerify/getProduceVerifyDetail', {
					usercode: api_localStorageGet("code"),
					proc: de_data.PROC_NO,
					workCenter: de_data.WORKSHOP_CENTER_CODE,
					taskNo: de_data.TASK_NO,
					eq_code: de_data.EQU_CODE
				}, function(data) {
					if (data.result) {
						console.log(JSON.stringify(data.data))
						document.getElementById('contentId').innerHTML = template('record-template', {
							"record": data.data
						});
					} else {
						plus.ui.toast(data.msg);
					}
				});
			}
		</script>
	</body>

</html>
